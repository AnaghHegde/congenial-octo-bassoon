{
  "unpublishedCollection": {
    "name": "JSObject1",
    "pageId": "LocationProductConstraints",
    "pluginId": "js-plugin",
    "pluginType": "JS",
    "actions": [],
    "archivedActions": [],
    "body": "export default {\n\tInit:() => {\n\t\tstoreValue(\"key_LPC_payload\", '');\n\t},\n\tGetConstraints: () =>{\n\t\tif(RessourceId.text == \"\"){\n\t\t\tshowAlert(\"Ressource Id Required\")\n\t\t}\n\t\telse{\n\t\t\tif(RessourceType.selectedOptionLabel == 'Berth'){\n\t\t\t\t\tBerthConstraints.run(\n\t\t\t\t\t\t\t//success\n\t\t\t\t\t\t\t() => {storeValue('Key_GetConstraintList', BerthConstraints.data);},\n\t\t\t\t\t\t\t//fail\n\t\t\t\t\t\t\t()=> {showAlert(JSON.stringify(BerthConstraints.data.message));}\n\t\t\t\t\t)\n\t\t\t}\n\t\t\telse if (RessourceType.selectedOptionLabel == 'Installation'){\n\t\t\t\t\tInstallationConstraints.run(\n\t\t\t\t\t\t//success\n\t\t\t\t\t\t() => {storeValue('Key_GetConstraintList', InstallationConstraints.data);},\n\t\t\t\t\t\t//fail\n\t\t\t\t\t\t()=> {showAlert(JSON.stringify(InstallationConstraints.data.message));}\n\t\t\t\t\t)\n\t\t\t}\n\t\t\telse if (RessourceType.selectedOptionLabel == 'Zone'){\n\t\t\t\t\tZoneConstraints.run(\n\t\t\t\t\t\t//success\n\t\t\t\t\t\t() => {storeValue('Key_GetConstraintList', ZoneConstraints.data);},\n\t\t\t\t\t\t//fail\n\t\t\t\t\t\t()=> {showAlert(JSON.stringify(ZoneConstraints.data.message));}\n\t\t\t\t\t)\n\t\t\t}\n\t\t}\n\t},\t\n\tcreateNewGsheet: () =>{\t\t\n\t\tif(CreateGSheet_NewLPC.data.webViewLink != null){\n\t\t\tnavigateTo(CreateGSheet_NewLPC.data.webViewLink,{},'NEW_WINDOW');\n\t\t}\n\t\telse {\n\t\t\tCreateGSheet_NewLPC.run(\n\t\t\t\t// success\n\t\t\t\t() => {storeValue('Key_URLCreateProductLPC', CreateGSheet_NewLPC.data.webViewLink);\n\t\t\t\t\t\t\t navigateTo(CreateGSheet_NewLPC.data.webViewLink,{},'NEW_WINDOW');},\n\t\t\t\t//fail\n\t\t\t\t() => {storeValue('Key_URLCreateProductLPC', '');showAlert(\"Something wrong happened - Can't create GSheet\");}\n\t\t\t)\n\t\t}\n\t},\t\n\tDeleteProductGroup:() =>{\n\t\tDeleteProductConstraintGroup.run(\n\t\t\t\t//success\n\t\t\t\t() => {showAlert('Constraint succesfully deleted');closeModal('DeleteConfirm');JSObject1.GetConstraints();},\n\t\t\t\t//fail\n\t\t\t\t() => {showAlert(JSON.stringify(DeleteProductConstraint.data.message));closeModal('DeleteConfirm');} \n\t\t\t)\n\t},\n\tDeleteProductConstraints:() =>{\n\t\tif (Constraints.selectedRow.NbConstraints>1){\n\t\t\tDeleteProductConstraint.run(\n\t\t\t\t//success\n\t\t\t\t() => {showAlert('Constraint succesfully deleted');closeModal('DeleteConfirm');JSObject1.GetConstraints();},\n\t\t\t\t//fail\n\t\t\t\t() => {showAlert(JSON.stringify(DeleteProductConstraint.data.message));closeModal('DeleteConfirm');} \n\t\t\t)\n\t\t}\n\t\telse{\n\t\t\tJSObject1.DeleteProductGroup();\n\t\t}\t\t\n\t},\n\tLoadNewConstraints:()=>{\n\t\tGetGSheetContent_LPC.run(\n\t\t\t//success\n\t\t\t() => {\n\t\t\t\tlet array_payload=[];\t\t\n\t\t\t\tlet APIdata = [];\t\t\t\t\t\n\t\t\t\tlet arrayconstraints = [];\n\t\t\t\tAPIdata = GetGSheetContent_LPC.data.values;\n\t\t\t\tif (APIdata.length==3){\n\t\t\t\t\tshowAlert('No data to load')\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tlet j=0;\n\t\t\t\t\tlet curType = \"\";\n\t\t\t\t\tfor (let i=3;i<APIdata.length;i++){\n\t\t\t\t\t\t// build the payload\t\t\t\t\t\t// \n\t\t\t\t\t\t// if PC id is empty or equal to the previous one and productId is not null, then handle as multiple products. Otherwise, new LPC\n\t\t\t\t\t\tcurType = APIdata[i][0];\n\t\t\t\t\t\tarrayconstraints=[];\t\n\t\t\t\t\t\tfor(j=i; j<APIdata.length; j++){\n\t\t\t\t\t\t\tif ((APIdata[j][0] == null || APIdata[j][0]==\"\" || APIdata[j][0]==curType) && (APIdata[j][11] != null || APIdata[j][11] != \"\")) {\n\t\t\t\t\t\t\t\tarrayconstraints.push({\n\t\t\t\t\t\t\t\t\t\"productId\": APIdata[j][11],\n\t\t\t\t\t\t\t\t\t\"ratio\": ((APIdata[j][12]==null||APIdata[j][12]==\"\")?null:APIdata[j][12]),\n\t\t\t\t\t\t\t\t\t\"parcelMin\": ((APIdata[j][13]==null||APIdata[j][13]==\"\")?null:({\"metric\":APIdata[j][13], \"unit\": APIdata[j][14]})),\n\t\t\t\t\t\t\t\t\t\"parcelMax\": ((APIdata[j][15]==null||APIdata[j][15]==\"\")?null:({\"metric\":APIdata[j][15], \"unit\": APIdata[j][16]})),\n\t\t\t\t\t\t\t\t\t\"parcelNominal\": ((APIdata[j][17]==null||APIdata[j][17]==\"\")?null:({\"metric\":APIdata[j][17], \"unit\": APIdata[j][18]})),\n\t\t\t\t\t\t\t\t\t\"parcelTolerance\": ((APIdata[j][19]==null||APIdata[j][19]==\"\")?null:APIdata[j][19])\n\t\t\t\t\t\t\t\t})\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t\tarray_payload.push({\n\t\t\t\t\t\t\t\"type\": APIdata[i][0],\t\n\t\t\t\t\t\t\t\"source\": ((APIdata[i][1]==null||APIdata[i][1]==\"\")?null:({\"locationId\": APIdata[i][1],\"type\": APIdata[i][2]})), \n\t\t\t\t\t\t\t\"destination\": ((APIdata[i][3]==null||APIdata[i][3]==\"\")?null:({\"locationId\": APIdata[i][3],\"type\": APIdata[i][4]})), \n\t\t\t\t\t\t\t\"start\": ((APIdata[i][5]==null||APIdata[i][5]==\"\")?null:APIdata[i][5]), \n\t\t\t\t\t\t\t\"end\": ((APIdata[i][6]==null||APIdata[i][6]==\"\")?null:APIdata[i][6]), \n\t\t\t\t\t\t\t\"minDwt\": ((APIdata[i][7]==null||APIdata[i][7]==\"\")?null:APIdata[i][7]), \n\t\t\t\t\t\t\t\"maxDwt\": ((APIdata[i][8]==null||APIdata[i][8]==\"\")?null:APIdata[i][8]),\n\t\t\t\t\t\t\t\"minCapacity\": ((APIdata[i][9]==null||APIdata[i][9]==\"\")?null:APIdata[i][9]),\n\t\t\t\t\t\t\t\"maxCapacity\": ((APIdata[i][10]==null||APIdata[i][10]==\"\")?null:APIdata[i][10]),\n\t\t\t\t\t\t\t\"productConstraints\": arrayconstraints\n\t\t\t\t\t\t});\n\t\t\t\t\t\ti=j-1;\n\t\t\t\t\t}\n\t\t\t\t\tstoreValue(\"key_LPC_payload\", array_payload);\n\t\t\t\t}\n\t\t\t},\n\t\t\t//fail\n\t\t\t() => {showAlert(\"Something went wrong - can't load data\");}\t\t\t\n\t\t)\n\t},\n\tAddConstraints:()=>{\n\t\tAddProductConstraint.run(\n\t\t\t// success\n\t\t\t() => {storeValue('Key_AddConstraintResponse', AddProductConstraint.data);storeValue('Key_APIFail', \"\");},\n\t\t\t// fail\n\t\t\t() => {storeValue('Key_AddConstraintResponse', AddProductConstraint.data.message);storeValue('Key_APIFail', AddProductConstraint.data.message);},\t\t\n\t\t)\n\t},\n\tcreateNewGsheet: () =>{\t\t\n\t\tif(CreateGSheet_NewLPC.data.webViewLink != null){\n\t\t\tnavigateTo(CreateGSheet_NewLPC.data.webViewLink,{},'NEW_WINDOW');\n\t\t}\n\t\telse {\n\t\t\tCreateGSheet_NewLPC.run(\n\t\t\t\t// success\n\t\t\t\t() => {storeValue('Key_URLCreateProductLPC', CreateGSheet_NewLPC.data.webViewLink);\n\t\t\t\t\t\t\t navigateTo(CreateGSheet_NewLPC.data.webViewLink,{},'NEW_WINDOW');},\n\t\t\t\t//fail\n\t\t\t\t() => {storeValue('Key_URLCreateProductLPC', '');showAlert(\"Something wrong happened - Can't create GSheet\");}\n\t\t\t)\n\t\t}\n\t},\n\tCreateEditGsheet:()=>{\t\t\n\t\t//reinit key_EditLPC_payload\n\t\tstoreValue('key_EditLPC_payload', \"\");\n\t\t// Build body for Gsheet content\n\t\tlet putBody = [];\n\t\tlet curConstraint=\"\";\n\t\tlet curConstraintArray=[];\n\t\tlet i=1;\n\t\tlet j=1;\n\t\tlet curArray=[];\n\t\tlet ConstraintIdArray = Constraints.selectedRow.ConstraintsForPopup;\n\t\t// split the description of constraints displayed to user. Pattern: ([..,..,..],[..,..,..],[..,..,..])\n\t\tlet contraintsArray = Constraints.selectedRow.Constraints.split(\"],\")\n\t\tfor (i=0; i<contraintsArray.length; i++){\n\t\t\tcurArray=[];\n\t\t\tcurConstraint = contraintsArray[i].replace(\"[\", \"\");\n\t\t\tcurConstraint = curConstraint.replace(\"]\", \"\");\n\t\t\tcurConstraintArray = curConstraint.split(\",\");\n\t\t\tif (i==0){\n\t\t\t\tcurArray.push(\n\t\t\t\t\tConstraints.selectedRow.Type,\n\t\t\t\t\tConstraints.selectedRow.OriginRessourceId,\n\t\t\t\t\tConstraints.selectedRow.OriginRessourceType,\n\t\t\t\t\tConstraints.selectedRow.DestinationRessourceId,\n\t\t\t\t\tConstraints.selectedRow.DestinationRessourceType,\n\t\t\t\t\tConstraints.selectedRow.Start,\n\t\t\t\t\tConstraints.selectedRow.End,\n\t\t\t\t\tConstraints.selectedRow.minDwt,\n\t\t\t\t\tConstraints.selectedRow.maxDwt,\n\t\t\t\t\tConstraints.selectedRow.minCapacity,\n\t\t\t\t\tConstraints.selectedRow.maxCapacity\n\t\t\t\t);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tcurArray.push(\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\");\n\t\t\t}\n\t\t\tcurArray.push(ConstraintIdArray[i].ConstraintId);\n\t\t\tfor (j=0; j<curConstraintArray.length; j++){\n\t\t\t\tif(j==0){\n\t\t\t\t\t//product Name\n\t\t\t\t\tcurArray.push(curConstraintArray[j].split(\" - \")[1]);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t//other prm\n\t\t\t\t\tcurArray.push(curConstraintArray[j].split(\":\")[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tputBody.push(curArray);\n\t\t}\n\t\tstoreValue('key_LPCEdit_Body', putBody);\t\t\n\t\tstoreValue('key_LPC_EditGroupId', Constraints.selectedRow.GroupId);\n\t\t\n\t\tCreateGSheet_EditLPC.run(\n\t\t\t//success\n\t\t\t() =>{\n\t\t\t\tPatchGSheetContent_EditLPC.run(\n\t\t\t\t\t//success\n\t\t\t\t\t() => {navigateTo(CreateGSheet_EditLPC.data.webViewLink,{},'NEW_WINDOW');showModal('EditConfirm');},\n\t\t\t\t\t() => {showAlert('Something wrong happened - cannot open Gsheet for edit')}\t\t\t\t\n\t\t\t\t);\t\t\t\t\n\t\t\t},\n\t\t\t//fail\n\t\t\t() =>{showAlert('Something wrong happened - cannot open Gsheet for edit')}\t\t\n\t\t)\t\n\t\t\n\t},\n\tLoadEditConstraints:()=>{\n\t\tGetGSheetContent_EditLPC.run(\n\t\t\t//success\n\t\t\t() => {\n\t\t\t\tlet array_payload=[];\t\n\t\t\t\tlet array_payload_products=[];\t\t\n\t\t\t\tlet array_payload_group=[];\t\t\t\n\t\t\t\tlet APIdata = [];\t\t\t\t\t\n\t\t\t\tlet arrayconstraints = [];\n\t\t\t\tlet tmpjson = {};\n\t\t\t\tAPIdata = GetGSheetContent_EditLPC.data.values;\n\t\t\t\tif (APIdata.length==3){\n\t\t\t\t\tshowAlert('No data to load')\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tarray_payload_group = {\n\t\t\t\t\t\t\t\"start\": ((APIdata[3][5]==null||APIdata[3][5]==\"\")?null:APIdata[3][5]), \n\t\t\t\t\t\t\t\"end\": ((APIdata[3][6]==null||APIdata[3][6]==\"\")?null:APIdata[3][6]), \n\t\t\t\t\t\t\t\"minDwt\": ((APIdata[3][7]==null||APIdata[3][7]==\"\")?null:APIdata[3][7]), \n\t\t\t\t\t\t\t\"maxDwt\": ((APIdata[3][8]==null||APIdata[3][8]==\"\")?null:APIdata[3][8]),\n\t\t\t\t\t\t\t\"minCapacity\": ((APIdata[3][9]==null||APIdata[3][9]==\"\")?null:APIdata[3][9]),\n\t\t\t\t\t\t\t\"maxCapacity\": ((APIdata[3][10]==null||APIdata[3][10]==\"\")?null:APIdata[3][10])\n\t\t\t\t\t\t};\t\t\t\t\t\n\t\t\t\t\tlet j=0;\n\t\t\t\t\tlet curType = \"\";\n\t\t\t\t\tlet i=3;\n\t\t\t\t\tfor (let i=3;i<APIdata.length;i++){\n\t\t\t\t\t\t\tif (APIdata[i][11] != null && APIdata[i][11] !=\"\") {\n\t\t\t\t\t\t\t\t\ttmpjson = {\n\t\t\t\t\t\t\t\t\t\t\"id\":  APIdata[i][11],\n\t\t\t\t\t\t\t\t\t\t\"productId\": APIdata[i][12]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (APIdata[i][13]!=null&&APIdata[i][13]!=\"\"){\n\t\t\t\t\t\t\t\t\t\ttmpjson.ratio = APIdata[i][13]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (APIdata[i][14]!=null&&APIdata[i][14]!=\"\"){\n\t\t\t\t\t\t\t\t\t\ttmpjson.parcelMin = {\"metric\":APIdata[i][14], \"unit\": APIdata[i][15]}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (APIdata[i][16]!=null&&APIdata[i][16]!=\"\"){\n\t\t\t\t\t\t\t\t\t\ttmpjson.parcelMax = {\"metric\":APIdata[i][16], \"unit\": APIdata[i][17]}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (APIdata[i][18]!=null&&APIdata[i][18]!=\"\"){\n\t\t\t\t\t\t\t\t\t\ttmpjson.parcelNominal = {\"metric\":APIdata[i][18], \"unit\": APIdata[i][19]}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (APIdata[i][20]!=null&&APIdata[i][20]!=\"\"){\n\t\t\t\t\t\t\t\t\t\ttmpjson.parcelTolerance = APIdata[i][20]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tarray_payload_products.push(tmpjson);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\tarray_payload.push({\n\t\t\t\t\t\t\t\"type\": APIdata[3][0],\t\n\t\t\t\t\t\t\t\"source\": ((APIdata[3][1]==null||APIdata[3][1]==\"\")?null:({\"locationId\": APIdata[3][1],\"type\": APIdata[3][2]})), \n\t\t\t\t\t\t\t\"destination\": ((APIdata[3][3]==null||APIdata[3][3]==\"\")?null:({\"locationId\": APIdata[3][3],\"type\": APIdata[3][4]})), \n\t\t\t\t\t\t\t\"start\": ((APIdata[3][5]==null||APIdata[3][5]==\"\")?null:APIdata[3][5]), \n\t\t\t\t\t\t\t\"end\": ((APIdata[3][6]==null||APIdata[3][6]==\"\")?null:APIdata[3][6]), \n\t\t\t\t\t\t\t\"minDwt\": ((APIdata[3][7]==null||APIdata[3][7]==\"\")?null:APIdata[3][7]), \n\t\t\t\t\t\t\t\"maxDwt\": ((APIdata[3][8]==null||APIdata[3][8]==\"\")?null:APIdata[3][8]),\n\t\t\t\t\t\t\t\"minCapacity\": ((APIdata[3][9]==null||APIdata[3][9]==\"\")?null:APIdata[3][9]),\n\t\t\t\t\t\t\t\"maxCapacity\": ((APIdata[3][10]==null||APIdata[3][10]==\"\")?null:APIdata[3][10]),\n\t\t\t\t\t\t\t\"productConstraints\": array_payload_products\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tstoreValue(\"key_EditLPC_payload\", array_payload);\n\t\t\t\t\tstoreValue(\"key_EditLPC_payloadGroup\", array_payload_group);\n\t\t\t\t\tstoreValue(\"key_EditLPC_payloadProduct\", array_payload_products);\n\t\t\t\t}\n\t\t\t},\n\t\t\t//fail\n\t\t\t() => {showAlert(\"Something went wrong - can't load data\");}\t\t\t\n\t\t)\n\t},\n\tPatchConstraints:() =>{\n\t\tEditProductConstraintGroup.run(\n\t\t\t\t//success\n\t\t\t\t() => {\t\t\t\t\t\n\t\t\t\t\t\t\tEditProductConstraintProducts.run(\n\t\t\t\t\t\t\t\t\t//success\n\t\t\t\t\t\t\t\t\t() => {showAlert('Constraint succesfully updated');closeModal('EditConfirm');JSObject1.GetConstraints();},\n\t\t\t\t\t\t\t\t\t//fail\n\t\t\t\t\t\t\t\t\t() => {showAlert(JSON.stringify(EditProductConstraintProducts.data.message));} \n\t\t\t\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\t//fail\n\t\t\t\t() => {showAlert(JSON.stringify(EditProductConstraintGroup.data.message));} \n\t\t\t)\n\t}\n}",
    "variables": []
  },
  "id": "LocationProductConstraints_JSObject1",
  "deleted": false,
  "gitSyncId": "61ae2cefd3e4214454c24ccd_61cd721ba4437918c01f8869"
}
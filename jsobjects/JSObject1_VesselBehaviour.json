{
  "unpublishedCollection": {
    "name": "JSObject1",
    "pageId": "VesselBehaviour",
    "pluginId": "js-plugin",
    "pluginType": "JS",
    "actions": [],
    "archivedActions": [],
    "body": "export default {\n\tInit:()=>{\n\t\tstoreValue('key_AddBehaviour_Payload', \"\");\n\t\tstoreValue('key_AddBehaviour_AddAPIFail', \"\");\n\t},\n\tSelectVessel:()=>{\n\t\tstoreValue('key_SelectedVessel_id', SelectVessel.selectedRow.id);\n\t\tcloseModal('Modal_VesselSearch');\n\t},\n\tDeleteVesselBehaviours:()=>{\n\t\tDeleteVesselBehaviour.run(\n\t\t\t//success\n\t\t\t() => {GetVesselBehaviour.run();closeModal('ModalDelete');},\n\t\t\t//fail\n\t\t\t() => {showAlert(\"Something went wrong - Can't delete vessel behaviour\");}\n\t\t)\n\t},\t\n\tGetVesselBehaviours:() => {\n\t\tGetVessel.run(\n\t\t\t// success\n\t\t\t() => {GetVesselBehaviour.run(\n\t\t\t\t//success\n\t\t\t\t() => {},\n\t\t\t\t//fail\n\t\t\t\t() => {showAlert(JSON.stringify(GetVesselBehaviour.data.message));}\n\t\t\t);},\n\t\t\t//fail\n\t\t\t() => {showAlert(JSON.stringify(GetVessel.data.message));}\t\t\n\t\t);\n\t},\n\tAddBehaviour:()=>{\t\t\n\t\tif(Input_VesselID.text==\"\"){\n\t\t\tshowAlert(\"Installation ID is required\");\n\t\t}\n\t\telse{\n\t\t\tlet buildPayload = {};\n\t\t\tbuildPayload = {\n\t\t\t\t\"vesselId\": Input_VesselID.text,\n\t\t\t\t\"behaviour\": AddBehaviour.selectedOptionValue,\n\t\t\t\t\"start\": (AddStart.text==\"\"?null:AddStart.text),\n\t\t\t\t\"end\": (AddTo.text==\"\"?null:AddTo.text)\n\t\t\t}\n\t\t\tstoreValue(\"key_AddBehaviour_Payload\",buildPayload)\n\t\t\t\n\t\t\tCreateVesselBehaviour.run(\n\t\t\t\t//success\t\n\t\t\t\t() => {storeValue(\"key_AddBehaviour_AddAPIFail\",\"\");JSObject1.GetVesselBehaviours();closeModal('ModalAdd')},\n\t\t\t\t//fail\n\t\t\t\t() => {showAlert(\"Something went wrong - New Vessel Behaviour not inserted\"); storeValue(\"key_AddBehaviour_AddAPIFail\", CreateVesselBehaviour.data.message)}\n\t\t\t)\t\t\t\n\t\t}\n\t},\n\tUpdateBehaviour:()=>{\n\t\tlet buildPayload = {};\n\t\tbuildPayload = {\n\t\t\t\"vesselId\": Input_VesselID.text,\n\t\t\t\"behaviour\": EditBehaviours.selectedOptionValue,\n\t\t\t\"start\": (EditSince.text==\"\"?null:EditSince.text),\n\t\t\t\"end\": (EditUntil.text==\"\"?null:EditUntil.text)\n\t\t}\n\t\tstoreValue(\"key_EditBehaviour_Payload\",buildPayload)\n\t\tEditVesselBehaviour.run(\n\t\t\t\t//success\t\n\t\t\t\t() => {storeValue(\"key_EditBehaviour_AddAPIFail\",\"\");JSObject1.GetVesselBehaviours();closeModal('ModalEdit')},\n\t\t\t\t//fail\n\t\t\t\t() => {showAlert(\"Something went wrong - Vessel Behaviour not updated\"); storeValue(\"key_EditBehaviour_AddAPIFail\", EditVesselBehaviour.data.message)}\t\t\n\t\t)\n\t},\n\tCreateNewGsheet: () =>{\n\t\tif(CreateGSheet_VesselBehaviour.data.webViewLink != null){\n\t\t\tnavigateTo(CreateGSheet_VesselBehaviour.data.webViewLink,{},'NEW_WINDOW');\n\t\t}\n\t\telse{\n\t\t\tCreateGSheet_VesselBehaviour.run(\n\t\t\t\t// success\n\t\t\t\t() => {storeValue('Key_URLCreateVesselBehaviour', CreateGSheet_VesselBehaviour.data.webViewLink);\n\t\t\t\t\t\t\t navigateTo(CreateGSheet_VesselBehaviour.data.webViewLink,{},'NEW_WINDOW');},\n\t\t\t\t//fail\n\t\t\t\t() => {storeValue('Key_URLCreateVesselBehaviour', '');showAlert(\"Fail\");}\n\t\t\t)\n\t\t}\n\t},\t\n\tCheckVesselBehaviours:()=>{\n\t\tGetGSheetContent_VesselBehav.run(\n\t\t\t//success\n\t\t\t() => {\n\t\t\t\tlet array_payload=[];\t\t\n\t\t\t\tlet APIdata = [];\n\t\t\t\tAPIdata = GetGSheetContent_VesselBehav.data.values;\n\t\t\t\tfor (let i=1;i<APIdata.length;i++){\n\t\t\t\t\tarray_payload.push({\n\t\t\t\t\t\t\"vesselId\": APIdata[i][0],\n\t\t\t\t\t\t\"behaviour\": APIdata[i][1],\n\t\t\t\t\t\t\"start\": ((APIdata[i][2]==null||APIdata[i][2]==\"\")?null:APIdata[i][2]),\n\t\t\t\t\t\t\"end\": ((APIdata[i][3]==null||APIdata[i][3]==\"\")?null:APIdata[i][3])\n\t\t\t\t\t})\t\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tstoreValue(\"Key_VB_ArrayPayload\", array_payload);\n\t\t\t},\n\t\t\t//fail\n\t\t\t() => {showAlert(\"Something went wrong - Can't get data from GSheet\")}\t\t\t\n\t\t)\n\t},\n\tBatchAddVesselBehaviours:()=>{\n\t\t// go through Key_VB_ArrayPayload, and append Key_AddAlias_Response as we receive the results\n\t\tlet array_payload=[];\t\n\t\tlet cur_payload={};\n\t\tlet result_array=[];\n\t\tarray_payload = appsmith.store.Key_VB_ArrayPayload;\n\t\t\n\t\tconst AddVBCall = array_payload.map(payload => CreateVesselBehaviour.run(()=>{}, ()=>{}, payload));\n\t\treturn Promise.allSettled(AddVBCall)\n\t\t\t.then(() => showAlert('Promise.allSettled - All successful'))\n\t\t\t.catch(() => showAlert('Promise.allSettled - Something went wrong'))\n\t\t\t.finally(() => showAlert('Promise.allSettled - finished'))\n\n\t\t/*\n\t\tPromise.alls\n\t\tPromise.\n\t\tfor (let i=0; i<array_payload.length; i++){\n\t\t\tcur_payload = array_payload[i];\n\t\t\tstoreValue(\"key_AddBehaviour_Payload\",cur_payload);\n\t\t\tCreateGSheet_VesselBehaviour.run().then((res) => {showAlert(res.message)})\n\t\t}\n\t\t*/\n\t}\n\t\t/*\n\t\tAddProductAlias.run(\n\t\t\t// success\n\t\t\t() => {storeValue('Key_AddAlias_Response', AddProductAlias.data);storeValue('Key_AddAlias_APIFail', \"\");}, \n\t\t\t//fail\n\t\t\t() => {storeValue('Key_AddAlias_Response', \"\");storeValue('Key_AddAlias_APIFail', AddProductAlias.data.message);})\n\t}*/\n}",
    "variables": []
  },
  "id": "VesselBehaviour_JSObject1",
  "deleted": false,
  "gitSyncId": "61ae2cefd3e4214454c24ccd_61fabb0f2cd3d95ca414a5d0"
}